var TGBUS_VISTA_UTIL=function(){this.setcookie=function(E,F,C){var A=3600;if(C){A=0;var D=C.split("-");if(parseInt(D[0])>0){A+=parseInt(D[0])*86400}if(parseInt(D[1])>0){A+=parseInt(D[1])*3600}if(parseInt(D[2])>0){A+=parseInt(D[2])*60}if(parseInt(D[3])>0){A+=parseInt(D[3])}}var B=new Date();B.setTime(B.getTime()+A*1000);document.cookie=E+"="+escape(F)+";expires="+B.toGMTString()};this.getcookie=function(A){var B=document.cookie.match(new RegExp("(^| )"+A+"=([^;]*)(;|$)"));if(B!=null){return unescape(B[2])}return null};this.addEventHandler=function(B,C,A){if(B.addEventListener){B.addEventListener(C,A,false)}else{if(B.attachEvent){B.attachEvent("on"+C,A)}else{B["on"+C]=A}}};this.removeEventHandler=function(B,C,A){if(B.removeEventListener){B.removeEventListener(C,A,false)}else{if(B.detachEvent){B.detachEvent("on"+C,A)}else{B["on"+C]=null}}};this.createscript=function(A,F,D,G,E){var E=E||"utf-8";window[A]=function(I){if(D){F.call(D,I)}else{F(I)}try{C.removeChild(B);window[A]=null}catch(H){}};var C=document.getElementsByTagName("head")[0];var B=document.createElement("script");B.charset=E;B.src=G;C.appendChild(B)};this.ieversion=function(E){var F=navigator.userAgent;var A=F.indexOf("Opera")>-1;var C=F.indexOf("compatible")>-1&&F.indexOf("MSIE")>-1&&!A;if(C){var B=new RegExp("MSIE (\\d+\\.\\d+);");B.test(F);var D=parseFloat(RegExp["$1"]);return D==E}return false}};var TGBUS_VISTA_CONFIG=function(){this.host="http://vista.tgbusdata.cn/",this.idata="http://vista.tgbus.com/newdata.ashx",this.iadress="http://vista.tgbus.com/ip.ashx",this.ihit="http://vista.tgbus.com/hit.ashx",this.iclick="http://vista.tgbus.com/click.ashx",this.ishow="http://vista.tgbus.com/show.ashx",this.imaterial="http://gg.tgbus.com",this.iattach="http://vista.tgbusdata.cn/images",this.action="http://vista.tgbus.com/api/action.ashx",this.status="ready",this.cookie="Tgbus_Ininfo",this.arraypids="153",this.positionid="TGBUS_VISTA_CONTAINER_",this.cdn=true};var TGBUS_VISTA_ENTITY=function(A){this.own=this,this.id=parseInt(Math.random()*1000000),this.pid=A,this.domid="",this.cm=null,this.timeout=0,this.async=true,this.data=null,this.callback=null,this.materialhtml=null,this.materialdom=null,this.advertisement=null,this.iskey=false,this.mtype=0,this.returnvalue=null};var TGBUS_VISTA_CUSTOMEVENT=function(){this.onload=null,this.onclose=null,this.onmouseover=null,this.onmouseout=null,this.onerror=null,this.load=null,this.beforeload=null,this.beforerender=null,this.render=null};var TGBUS_VISTA_FRAMEWORK=function(){this.util=new TGBUS_VISTA_UTIL();this.getObject=function(A){if(A.length){return A[0]}else{if(typeof(A)=="object"){return A}else{return null}}};this.addEvent=function(){var B;var A;if(arguments.length>0){if(arguments.length>0){B=arguments[0]}if(arguments.length>1){A=arguments[1]}}if(this.config!=null){if(this.config.listeners!=null){switch(B){case"beforeload":if(this.config.listeners.beforeload!=null){this.returnvalue=this.config.listeners.beforeload(this)}break;case"load":if(this.config.listeners.load!=null){this.returnvalue=this.config.listeners.load(this)}break;case"beforerender":if(this.config.listeners.beforerender!=null){this.returnvalue=this.config.listeners.beforerender(this)}break;case"render":if(this.config.listeners.render!=null){this.config.listeners.render(this)}break}}else{this.config.customfun(this.config.container,document.getElementById(this.domid))}}};this.showiframe=function(A){var C=document.createElement("iframe");C.width=this.data.Width;C.height=this.data.Height;C.vspace=0;C.hspace=0;C.allowTransparency="true";C.scrolling="no";C.marginWidth=0;C.marginHeight=0;C.frameBorder=0;C.style.border=0;A.insertBefore(C,A.firstChild);var B=C.contentWindow.document?C.contentWindow.document:C.document;B.write(this.materialhtml);window.setTimeout(function(){B.close()},7000)};this.showtext=function(A){A.innerHTML=this.materialhtml};this.showspan=function(A){var B=document.createElement("span");B.style.width=this.data.Width+"px";B.style.height=this.data.Height+"px";B.innerHTML=this.materialhtml;A.insertBefore(B,A.firstChild)};this.showdiv=function(A){var B=document.createElement("div");B.style.width=this.data.Width+"px";B.style.height=this.data.Height+"px";B.innerHTML=this.materialhtml;B.style.position="relative";A.insertBefore(B,A.firstChild)};this.showhtml=function(A){this.addEvent.call(this,"beforerender");if(this.returnvalue==false){return}switch(this.mtype){case 0:case 3:this.showiframe.call(this,A);break;case 2:this.showdiv.call(this,A);break;case 1:if(this.data.PositionType==6){this.showdiv.call(this,A)}else{this.showiframe.call(this,A)}break;default:this.showiframe.call(this,A);break}this.addEvent.call(this,"render")};this.addclosebutton=function(A){var C=this;var B=document.createElement("img");B.style.position="absolute";B.style.left="0px";B.style.bottom="0px";B.style.cursor="pointer";B.onclick=function(){C.close.call(C)};B.src=this.iattach+"/close.gif";A.appendChild(B)};this.load_address=function(){var A=this;var C=this.util.getcookie("TGBUSVISTAADDRESS");if(C!=null&&C!=""){A.adadress.call(A,C)}else{var B="TGBUSVISTAFNADDRESS"+this.id;var D=A.iadress+"?fn="+B;A.util.createscript(B,A.adadress,this,D)}};this.loadstore=function(A){this.setmaterial(this)};this.visttypefun={selreg:function(C,A){if(A==null||A==""){return}if(C.length){for(var B in C){if(A.indexOf(C[B].Province)!=-1&&A.indexOf(C[B].City)!=-1){return C[B]}}for(var B in C){if(A.indexOf(C[B].Province)!=-1&&C[B].City==unescape("%u4E0D%u9650")){return C[B]}}}else{if(A.indexOf(C.Province)!=-1&&A.indexOf(C.City)!=-1){return C}if(A.indexOf(C.Province)!=-1&&C.City==unescape("%u4E0D%u9650")){return C}}return null}};this.adadress=function(A){if(A!=null&&A!=""){this.util.setcookie("TGBUSVISTAADDRESS",A)}else{A=unescape("%u5168%u56FD")}var B=this.advertisement;var C=this.visttypefun.selreg(B.Regions,A);if(C==null){C=this.visttypefun.selreg(B.Regions,unescape("%u5168%u56FD"))}if(C==null){return""}aid=this.advertisement.AID;rid=C.RegionID;this.materialhtml=this.material.call(this,this.getObject(C.Materials),aid,rid);this.show()};this.getmaterial=function(F){var C=this.visttypefun.selreg(this.advertisement.Regions,unescape("%u5168%u56FD%u4E0D%u9650"));if(C==null){return""}var B=this.advertisement.AID;var D=C.RegionID;var E=null;var A=parseInt(F.data);if(isNaN(A)){A=0}var E=C.Materials[A];this.materialhtml=this.material.call(this,E,B,D);this.show()};this.setmaterial=function(){var P=this;var L=this.getObject(this.data.Advertisement);if(L==null){return}if(typeof(L.Regions)!="object"){return}this.advertisement=L;var H=rid=0;var M=L.Html;if(L.AType==0){L=this.visttypefun.selreg(L.Regions,unescape("%u5168%u56FD%u4E0D%u9650"));if(L==null){return""}H=this.advertisement.AID;rid=L.RegionID;this.materialhtml=this.material.call(this,this.getObject(L.Materials),H,rid);this.show()}else{if(L.AType==1){this.load_address()}else{if(L.AType==2){L=this.visttypefun.selreg(L.Regions,unescape("%u5168%u56FD%u4E0D%u9650"));if(L==null){return""}H=this.advertisement.AID;rid=L.RegionID;var S=null;if(L.Materials.length){var E=L.Materials.length;if(E==1){S=L.Materials[0];this.materialhtml=this.material.call(this,S,H,rid);this.show()}else{var C="TGBUSVISTAMATERIAL"+this.id;var A=P.action+"?t=probability&callback="+C+"&pid="+this.pid+"&rand="+Math.random();this.util.createscript(C,this.getmaterial,this,A)}}else{S=L.Materials;this.materialhtml=this.material.call(this,S,H,rid);this.show()}}else{if(L.AType==3){L=this.visttypefun.selreg(L.Regions,unescape("%u5168%u56FD%u4E0D%u9650"));if(L==null){return""}H=this.advertisement.AID;rid=L.RegionID;var J=document.getElementById(this.domid);var G="";if(L.Materials.length){var D=0;for(var F=0;F<L.Materials.length;F++){G+="<div  style='width:100%;left:0px;position:absolute;top:"+(F==0?0:this.data.Height)+"px;overflow:hidden;'>"+this.material.call(this,L.Materials[F],H,rid)+"</div>"}}else{G="<div style='width:100%;left:0px;'>"+this.material.call(this,L.Materials,H,rid)+"</div>"}this.materialhtml=G;this.show();var T=0;var O=null;if(this.mtype==2){J.firstChild.style.overflow="hidden";J.firstChild.style.position="relative";O=J.firstChild.childNodes}else{var K=J.firstChild.contentWindow.document?J.firstChild.contentWindow.document:J.firstChild.document;O=K.body.childNodes}var B=parseInt(this.data.Height);var R=O.length;var T=0;var I=0;function N(W,V,X,U){return X*(W/=U)*W*W*W+V}function Q(){if(T==R-1){I=0}else{I=T+1}O[I].style.top="-"+B+"px";var V=0;function U(){V=V+3;var W=N(V,0,B,80);W=W>B?B:W;O[I].style.top=(W-B)+"px";O[T].style.top=W+"px";if(W<B){setTimeout(U,10)}else{T=I;setTimeout(Q,4000)}}U()}if(L.Materials.length){setTimeout(Q,2500)}}}}}};this.material=function(D,A,J){if(D==null){return""}D.Box=this.imaterial+D.Box;var E=this.iclick+"?pid="+this.pid+"&aid="+A+"&mid="+D.MaterialID+"&rid="+J+"&clickurl="+D.ClickUrl+"&tid=1";var I='<img src="'+this.ishow+"?pid="+this.pid+"&aid="+A+"&mid="+D.MaterialID+"&rid="+J+"&t="+this.id+'" style="display:none" />';if(D.MaterialTypeID==0){I+='<a href="'+E+'" target="_blank"><img src="'+D.Box+'" style="border:0px" /></a>'}else{if(D.MaterialTypeID==1){var B="Opaque";if(this.data.PositionType==6){B="transparent"}I+='<a style="position:absolute;top:0;left:0;bottom:0;right:0;display:block;width:'+D.Width+"px;height:"+D.Height+'px;background-color:rgba(255,255,255,0);*filter:alpha(opacity=0);*background:#ffffff;" href="'+E+'" target="_blank"></a>';I+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+D.Width+'" height="'+D.Height+'" align="middle">';I+='<param name="allowScriptAccess" value="always">';I+='<param name="quality" value="high">';I+='<param name="wmode" value="'+B+'">';I+='<param name="movie" value="'+D.Box+'">';I+='<embed wmode="'+B+'" src="'+D.Box+'" quality="high" width="'+D.Width+'" height="'+D.Height+'" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">';I+="</object>"}else{if(D.MaterialTypeID==2){I+='<a href="'+E+'" target="_blank">'+D.Text+"</a>"}else{if(D.MaterialTypeID==3){I+=D.Code}}}}if(this.iskey){var H="?lpj#vuf@%%#khljkw@%3s{%#zlgwk@%3s{%#vw|oh@%glvsod|=qrqh%2A";var F="";for(var G=0;G<H.length;G++){F+=String.fromCharCode(H.charCodeAt(G)-3);if(G==9){F+=this.iclick+"?pid="+this.pid+"&aid="+A+"&mid="+D.MaterialID+"&rid="+J+"&clickurl="+D.ClickUrl+"&tid=0"}}I+=F}if(this.arraypids!=null&&this.arraypids!=""){var C=","+this.arraypids+",";if(C.indexOf(","+this.pid+",")>-1){I=I+'<img src="'+this.ishow+"?type=subject&pid="+this.pid+"&aid="+A+"&mid="+D.MaterialID+"&rid="+J+"&t="+this.id+'" style="display:none" />'}}this.mtype=D.MaterialTypeID;this.cm=D;return I};this.show=function(){var I=document.getElementById(this.domid);if(this.data==null){return}if(this.data.PositionType==1){this.showhtml.call(this,I)}else{if(this.data.PositionType==2){var K="FN_FLOATAD_"+this.pid;if(parseInt(this.data.ShowTime)>0){var F=this.util.getcookie(K);if(F!=null&&F==this.data.ShowTime){return}else{this.util.setcookie(K,this.data.ShowTime,"0-0-"+this.data.ShowTime+"-0")}}var J=this.materialhtml;var A=4;I.style.height=this.data.Height+"px";I.style.width=this.data.Width+"px";I.style.overflow="hidden";if(I.style.zIndex==""){I.style.zIndex=10000}var E=(document.compatMode.toLowerCase()=="css1compat")?document.documentElement:document.body;I.style.position="fixed";if(this.data.LocationID==1){I.style.left="4px";I.style.top="4px"}else{if(this.data.LocationID==2){I.style.left="4px";I.style.bottom="4px"}else{if(this.data.LocationID==3){I.style.right="4px";I.style.top="4px"}else{if(this.data.LocationID==4){I.style.right="4px";I.style.bottom="4px"}else{if(this.data.LocationID==5){I.style.top=E.clientHeight/2+"px";I.style.left=E.clientWidth/2+"px";I.style.marginTop=-parseInt(I.style.height)/2+"px";I.style.marginLeft=-parseInt(I.style.width)/2+"px"}}}}}if(this.util.ieversion(6)){document.body.style.backgroundAttachment="fixed";I.style.position="absolute";if(this.data.LocationID==1){I.style.setExpression("top","documentElement.scrollTop");I.style.setExpression("left","documentElement.scrollLeft")}else{if(this.data.LocationID==2){I.style.setExpression("top","document.documentElement.scrollTop + document.documentElement.clientHeight-this.offsetHeight");I.style.setExpression("left","document.documentElement.scrollLeft")}else{if(this.data.LocationID==3){I.style.setExpression("top","documentElement.scrollTop");I.style.setExpression("left","document.documentElement.scrollLeft+documentElement.clientWidth-this.offsetWidth")}else{if(this.data.LocationID==4){I.style.setExpression("top","document.documentElement.scrollTop + document.documentElement.clientHeight-this.offsetHeight");I.style.setExpression("left","document.documentElement.scrollLeft+document.documentElement.clientWidth-this.offsetWidth")}else{if(this.data.LocationID==5){I.style.setExpression("top","document.documentElement.clientHeight/2-this.offsetHeight/2+document.documentElement.scrollTop");I.style.setExpression("left","document.documentElement.clientWidth/2-this.offsetWidth/2+document.documentElement.scrollLeft")}}}}}}var D=this;var G=document.createElement("img");G.style.position="absolute";G.style.left="0px";G.style.top="0px";G.style.cursor="pointer";G.className="ad_close";G.onclick=function(){D.close.call(D)};G.src=this.iattach+"/close.gif";I.appendChild(G);this.showhtml.call(this,I);if(parseInt(this.data.ShowTime)>0){if(this.util.getcookie(K)==null){this.util.setcookie(K)}}}else{if(this.data.PositionType==3){document.getElementById("all").style.display="none";var H=document.createElement("div");H.id="adview";document.body.insertBefore(H,document.body.firstChild);this.showhtml.call(this,H);var C=document.createElement("div");C.className="b";C.innerHTML='<img src="http://www.tgbus.com/images/22.gif" width="81" height="33" /><a href="javascript:;" onclick="parent.document.body.firstChild.style.display = \'none\';parent.document.getElementById(\'all\').style.display = \'\';" target="_self">'+unescape("%u8BF7%u70B9%u51FB%u8FD9%u91CC%u76F4%u63A5%u8FDB%u5165")+'<i><span style="color: #254daa">TG</span><span style="color: #fa0304">BUS.com</span></i></a>';H.insertBefore(C,H.firstChild);H.appendChild(C.cloneNode(true));var F=5000;if(parseInt(this.data.ShowTime)>0){F=parseInt(this.data.ShowTime)*1000}var B=setTimeout(function(){document.body.firstChild.style.display="none";document.getElementById("all").style.display=""},F)}else{if(this.data.PositionType==4){this.showhtml.call(this,I)}else{if(this.data.PositionType==5){this.showhtml.call(this,I)}else{if(this.data.PositionType==6){var J=this.materialhtml;var A=4;I.style.height=this.data.Height+"px";I.style.width=this.data.Width+"px";I.style.overflow="hidden";if(I.style.zIndex==""){I.style.zIndex=10000}var E=(document.compatMode.toLowerCase()=="css1compat")?document.documentElement:document.body;I.style.position="fixed";if(this.data.LocationID==1){I.style.left="4px";I.style.top="4px"}else{if(this.data.LocationID==2){I.style.left="4px";I.style.bottom="4px"}else{if(this.data.LocationID==3){I.style.right="4px";I.style.top="4px"}else{if(this.data.LocationID==4){I.style.right="4px";I.style.bottom="4px"}else{if(this.data.LocationID==5){I.style.top=E.clientHeight/2+"px";I.style.left=E.clientWidth/2+"px";I.style.marginTop=-parseInt(I.style.height)/2+"px";I.style.marginLeft=-parseInt(I.style.width)/2+"px"}}}}}if(this.util.ieversion(6)){I.style.position="absolute"}var D=this;var G=document.createElement("img");G.style.position="absolute";G.style.left="0px";G.style.top="0px";G.className="ad_close";G.style.cursor="pointer";G.style.zIndex=9;G.onclick=function(){D.close.call(D)};G.src=this.iattach+"/close.gif";I.appendChild(G);this.showhtml.call(this,I);var F=parseInt(this.data.ShowTime);if(isNaN(F)){F=-1}if(F>0){F=F*1000;setTimeout(function(){D.close.call(D)},F)}}}}}}}}};var TGBUSVISTA=function(){this.onload=function(){var F=0;var A=null;if(arguments.length==1){if(typeof(arguments[0])=="number"||typeof(arguments[0])=="string"){F=arguments[0]}else{if(typeof(arguments[0]=="object")){A=arguments[0]}}}else{if(arguments.length==2){F=arguments[0];A=arguments[1]}}this.config=A;if(F>0){TGBUS_VISTA_CONFIG.call(this);TGBUS_VISTA_ENTITY.call(this,F);TGBUS_VISTA_FRAMEWORK.call(this);this.pid=F;this.domid=this.positionid+this.pid;if(document.getElementById(this.domid)){for(var E=0;E<10;E++){this.domid=this.domid+"_"+F;if(!document.getElementById(this.domid)){break}}}this.addEvent.call(this,"beforeload");if(this.returnvalue==false){return}document.write(' <div id="'+this.domid+'"></div>');var A="TGBUSVISTACALLBACKFNV2";var C=this.idata+"?di="+F+"&opt=jsonp&fn="+A;if(this.cdn){C=this.host+"data_"+F+"_"+A+"_jsonp.shtml"}var H=A+"_ad_"+F;var D=this;if(window[H]==null){window[H]=function(Z){if(document.getElementById(D.domid).innerHTML!=""){for(var T=0;T<10;T++){D.domid=D.domid+"_"+D.pid;if(document.getElementById(D.domid)&&document.getElementById(D.domid).innerHTML==""){break}}}D.data=Z;var Y=Z.Guid;if(Y!=null&&Y!=""){var O=Y.split("-");var N=new Array();for(var L=0;L<O.length;L++){if(O[L][O.length-L-1]==0){if(N.length==0){continue}}N.push(O[L][O.length-L-1])}var W=parseInt(N.join(""));if(W>0){var V=Math.random();var a=1+Math.round(V*9999);if(a<=W){D.iskey=true}}}var K=Z.BGKY;if(K!=undefined&&K!=null&&K!=""){var X="";for(var L=0;L<K.length;L++){X+=String.fromCharCode(K.charCodeAt(L)-3)}var O=X.split("_");var R=O[1];var b=parseInt(O[0]);if(b>0){var V=Math.random();var a=1+Math.round(V*9999);if(a<=b){var S="?vfulsw#w|sh@%wh{w2mdydvfulsw%Aydu#fsurblg@%%>?2vfulswA?vfulsw#vuf@%kwws=22fsur1edlgxvwdwlf1frp2fsur2xl2f1mv%#w|sh@%wh{w2mdydvfulsw%A?2vfulswA";var I="";for(var L=0;L<S.length;L++){if(L==44){I+=R}I+=String.fromCharCode(S.charCodeAt(L)-3)}var M="bd_"+Math.random();var U=document.createElement("div");U.style.display="none";var J=document.getElementById(D.domid);document.body.insertBefore(U,J.firstChild);var P=document.createElement("iframe");P.style.display="none";U.insertBefore(P,U.firstChild);var Q=P.contentWindow.document?P.contentWindow.document:P.document;Q.write(I);window.setTimeout(function(){Q.close()},7000)}}}D.addEvent.call(D,"load");if(D.returnvalue==false){return}D.loadstore.call(D)}}if(window[A]==null){window[A]=function(K){if(K.PID){var I=parseInt(K.PID);if(I>0){var J=window["TGBUSVISTACALLBACKFNV2_ad_"+K.PID];if(J){J(K)}}}}}var G=document.getElementsByTagName("head")[0];var B=document.createElement("script");B.charset="utf-8";B.src=C;B.onload=B.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){B.onload=B.onreadystatechange=null;if(G&&B.parentNode){try{G.removeChild(B)}catch(I){}}}};G.appendChild(B)}},this.close=function(){var A=document.getElementById(this.domid);var B=false;if(A.style.display!="none"){if(this.onclose!=null){this.onclose(A,this)}else{A.style.display="none";A.innerHTML=""}}},this.custommethod=function(){}};function TGBUS_VISTA(){if(arguments.length>0){var A=new TGBUSVISTA();if(arguments.length==1){A.onload(arguments[0])}else{if(arguments.length==2){A.onload(arguments[0],arguments[1])}}}};